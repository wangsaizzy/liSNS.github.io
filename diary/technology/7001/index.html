<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>浏览器的CSS Hacks</title>
<link rel="stylesheet" type="text/css" href="../../../css/style.css" />
<style type="text/css">
	div#post ul li a {
	color: #915555
}
div#post ul li ul li a {
	color: #776868
}
div#post ul li ul li ul li a {
	color: #898989
}
div#post h1 {
	color: #915555;
	font-size: 22px;
	padding: 15px 0
}
div#post h2 {
	color: #776868;
	font-size: 18px;
	padding: 10px 0
}
div#post h3 {
	color: #898989;
	font-size: 18px;
	padding: 10px 0
}
div#post ul li a:hover {
	color: black;
	text-shadow: #333 0 0 1px
}
a:hover {
	color: #444;
	cursor: url("images/link.cur"), auto
}
pre {
	word-wrap: break-word;
	word-break: normal
}
#post ul li ul {
	padding-left: 18px
}
#post ul {
	padding-left: 18px
}
#post li {
	padding: 3px 0
}
</style>
</head>

<body>
<div id="post">
<ul id="markdown-toc">
	<li><a href="#section">新增的语义化标签</a>
<ul>
	<li><a href="#section-1">新的页面结构以及宽松的语法规范</a></li>
	<li><a href="#section-2">新的结构化元素</a></li>
	<li><a href="#section-3">语义化标签</a></li>
	<li><a href="#ie">IE下的兼容</a></li>
	<li><a href="#forms">forms</a></li>
</ul>
</li>
	<li><a href="#html5">HTML5新特性的浏览器支持情况</a></li>
	<li><a href="#section-4">新的选择器</a></li>
	<li><a href="#class">获取class列表属性</a></li>
	<li><a href="#json">JSON的新方法<!--more-->

</a></li>
	<li><a href="#data">data自定义数据</a></li>
	<li><a href="#js">延迟加载JS</a></li>
	<li><a href="#section-5">历史管理</a></li>
	<li><a href="#section-6">拖放事件</a></li>
	<li><a href="#section-7">跨文档消息通信</a>
<ul>
	<li><a href="#postmessage">postMessage对象</a></li>
	<li><a href="#xmlhttprequest-level-2">XMLHttpRequest Level 2</a></li>
	<li><a href="#websocket">websocket</a></li>
</ul>
</li>
	<li><a href="#html5applicationcache">HTML5的离线存储（applicationCache）</a>
<ul>
	<li><a href="#section-8">搭建离线应用程序</a></li>
</ul>
</li>
	<li><a href="#web-workers">Web Workers</a></li>
	<li><a href="#html5-1">HTML5其他功能</a>
<ul>
	<li><a href="#section-9">内容编辑</a></li>
	<li><a href="#section-10">语言输入</a></li>
	<li><a href="#section-11">桌面提醒</a></li>
</ul>
</li>
	<li><a href="#geolocation">地理信息（Geolocation）</a></li>
	<li><a href="#section-12">本地存储</a></li>
	<li><a href="#section-13">音频和视频</a></li>
</ul>
<h1 id="section">新增的语义化标签</h1>
<h2 id="section-1">新的页面结构以及宽松的语法规范</h2>
<pre><code class="language-html">&lt;!doctype html&gt;
&lt;html&gt;
	&lt;head&gt;
		&lt;meta charset="utf-8"/&gt;
		&lt;title&gt;&lt;/title&gt;
	&lt;/head&gt;
	&lt;body&gt;
	&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h2 id="section-2">新的结构化元素</h2>
<ul>
	<li>语义化标签的由来 <a href="http://devfiles.myopera.com/articles/572/idlist-url.htm">http://devfiles.myopera.com/articles/572/idlist-url.htm</a></li>
</ul>
<h2 id="section-3">语义化标签</h2>
<ul>
	<li>&lt;header&gt;&lt;/header&gt; 页眉
<ul>
	<li>主要用于页面的头部的信息介绍，也可用于板块头部</li>
</ul>
</li>
	<li>&lt;hgroup&gt;&lt;/hgroup&gt; 页面上的一个标题组合
<ul>
	<li>一个标题和一个子标题，或者标语的组合</li>
</ul>
</li>
</ul>
<pre><code class="language-html">&lt;hgroup&gt;
	&lt;h1&gt;妙味课堂&lt;/h1&gt;
	&lt;h1&gt;待您进入富有人情味的IT培训&lt;/h1&gt;
&lt;/hgroup&gt;
</code></pre>
<ul>
	<li>&lt;nav&gt;&lt;/nav&gt;导航（包含链接的一个列表）</li>
</ul>
<pre><code class="language-html">&lt;nav&gt;&lt;a href="#"&gt;链接&lt;/a&gt;&lt;a href="#"&gt;链接&lt;/a&gt;&lt;/nav&gt;
---
&lt;nav&gt;
	&lt;p&gt;&lt;a href="#"&gt;妙味课堂&lt;/a&gt;&lt;/p&gt;
	&lt;p&gt;&lt;a href="#"&gt;妙味课堂&lt;/a&gt;&lt;/p&gt;
&lt;/nav&gt;
---
&lt;nav&gt;
	&lt;h1&gt;妙味精品课程&lt;/h1&gt;
	&lt;ul&gt;
		&lt;li&gt;&lt;a href="#"&gt;javascript&lt;/a&gt;&lt;/li&gt;
		&lt;li&gt;&lt;a href="#"&gt;html+css&lt;/a&gt;&lt;/li&gt;
	&lt;/ul&gt;
&lt;/nav&gt;
</code></pre>
<ul>
	<li>&lt;footer&gt;&lt;/footer&gt; 页脚 页面的底部 或者 版块底部</li>
	<li>&lt;section&gt;&lt;/section&gt; 页面上的板块</li>
	<li>&lt;article&gt;&lt;/article&gt; 用来在页面中表示一套结构完整且独立的内容部分
<ul>
	<li>可以用来呈现论坛的一个帖子、杂志或报纸中的一篇文章、一篇博客、用户提交的评论内容、可互动的页面模块挂件等。</li>
</ul>
</li>
	<li>&lt;aside&gt;&lt;/aside&gt; 元素标签可以包含与当前页面或主要内容相关的引用、侧边栏、广告、nav元素组、以及其他类似的有别于主要内容的部分
<ul>
	<li>aside的内容应该与article的内容相关</li>
	<li>被包含在&lt;article&gt;中作为主要内容的附属信息部分，其中的内容是与当前文章有关的引用、词汇列表等</li>
	<li>在&lt;article&gt;之外使用，作为页面或站点全局的附属信息部分；最典型的形式是侧边栏（sidebar），其中的内容可以是友情链接、附属导航或广告单元等。</li>
</ul>
</li>
	<li>&lt;figure&gt;&lt;/figure&gt;用于对元素进行组合。一般用于图片或视频</li>
	<li>&lt;figcaption&gt;&lt;/figcaption&gt; figure的子元素 用于对figure的内容进行说明</li>
</ul>
<pre><code class="language-html">&lt;figure&gt;
	&lt;img src="miaov.png" /&gt; //注意没有alt
	&lt;figcaption&gt;妙味课堂 photo&amp;copy 妙味趣学&lt;/figcaption&gt;
&lt;/figure&gt;
</code></pre>
<ul>
	<li>&lt;time&gt;&lt;/time&gt; 用来表现时间或日期</li>
</ul>
<pre><code class="language-html">&lt;p&gt;
	我们在每天早上&lt;time&gt;9:00&lt;/time&gt;开始营业。
&lt;/p&gt;
&lt;p&gt;
	我在&lt;time datetime="2008-02-14"&gt;情人节&lt;/time&gt;有个约会。
&lt;/p&gt;
</code></pre>
<ul>
	<li>&lt;datalist&gt;&lt;/datalist&gt; 选项列表。与input元素配合使用，来定义input可能的值。</li>
</ul>
<pre><code class="language-html">&lt;input type="text" list="valList" /&gt;
&lt;datalist id="valList"&gt;
	&lt;option value="javascript"&gt;javascript&lt;/option&gt;
	&lt;option value="html"&gt;html&lt;/option&gt;
	&lt;option value="css"&gt;css&lt;/option&gt;
&lt;/datalist&gt;
</code></pre>
<ul>
	<li>&lt;details&gt;&lt;/details&gt; 用于描述文档或文档某个部分的细节
<ul>
	<li>该元素用于摘录引用等 应该与页面的主要内容区分开的其他内容</li>
	<li>open属性默认展开</li>
</ul>
</li>
	<li>&lt;summary&gt;&lt;/summary&gt; details元素的标题</li>
</ul>
<pre><code class="language-html">&lt;details&gt;
	&lt;summary&gt;妙味课堂&lt;/summary&gt;
	&lt;p&gt;国内将知名的IT培训机构&lt;/p&gt;
&lt;/details&gt;
</code></pre>
<ul>
	<li>&lt;dialog&gt;&lt;/dialog&gt; 定义一段对话</li>
</ul>
<pre><code class="language-html">&lt;dialog&gt;
	&lt;dt&gt;老师&lt;/dt&gt;
	&lt;dd&gt;2+2等于？&lt;/dd&gt;
	&lt;dt&gt;学生&lt;/dt&gt;
	&lt;dd&gt;4&lt;/dd&gt;
	&lt;dt&gt;老师&lt;/dt&gt;
	&lt;dd&gt;答对了！&lt;/dd&gt;
&lt;/dialog&gt;
</code></pre>
<ul>
	<li>&lt;address&gt;&lt;/address&gt; 定义文章或页面作者的详细联系信息</li>
	<li>&lt;mark&gt;&lt;/mark&gt; 需要标记的词或句子</li>
	<li>&lt;keygen&gt;给表单添加一个公钥</li>
</ul>
<pre><code class="language-html">&lt;form action="http://www.baidu.com" method="get"&gt;
	用户：&lt;input type="text" name="usr_name" /&gt;
	公钥：&lt;keygen name="security" /&gt;
	&lt;input type="submit"&gt;
&lt;/form&gt;
</code></pre>
<ul>
	<li>&lt;progress&gt;&lt;/progress&gt; 定义进度条</li>
</ul>
<pre><code class="language-html">&lt;progress max="100" value="76"&gt;
	&lt;span&gt;76&lt;/span&gt;% //该行用于向下兼容
&lt;/progress&gt;
</code></pre>
<h2 id="ie">IE下的兼容</h2>
<ul>
	<li>插件：html5shiv.js</li>
	<li>标签
<ul>
	<li>针对IE6-8这些不支持HTML5语义化标签的浏览器，我们可以使用javascript来解决他们。方法：在页面的头部加上：</li>
</ul>
</li>
</ul>
<pre><code class="language-html">&lt;script&gt;
	document.createElement('header');
	document.createElement('nav');
	document.createElement('footer');
	...
&lt;/script&gt;
</code></pre>
<ul>
	<li>样式
<ul>
	<li>HTML5语义化标签在IE6-8下，我们用js创造出来之后，它是不会有任何默认样式的甚至是display，所以在样式表里，要对这些标签定义一下它们默认的display</li>
</ul>
</li>
</ul>
<h2 id="forms">forms</h2>
<ul>
	<li>新的输入型控件 -email：电子邮箱文本框，跟普通的没什么区别 - 当输入不是邮箱的时候，验证通不过 - 移动端的键盘会有变化
<ul>
	<li>tel：电话号码</li>
	<li>url：网页的URL</li>
	<li>search：搜索引擎
<ul>
	<li>chrome下输入文字后，会多出一个关闭的X</li>
</ul>
</li>
	<li>range：特定范围内的数值选择器
<ul>
	<li>min、max、step（步数）</li>
	<li>例子：用js来显示当前数值</li>
</ul>
</li>
	<li>number：只能包含数字的输入框</li>
	<li>color：颜色选择器</li>
	<li>datetime：显示完整日期</li>
	<li>datetime-local：显示完整日期，不含时区</li>
	<li>time：显示时间，不含时区</li>
	<li>date：显示日期</li>
	<li>week：显示周</li>
	<li>month：显示月</li>
</ul>
</li>
	<li>新的表单特性和函数
<ul>
	<li>placeholder：输入框提示信息
<ul>
	<li>例子：微博的密码框提示</li>
</ul>
</li>
	<li>autocomplete：是否保存用户输入值
<ul>
	<li>默认为on，关闭提示选择off</li>
</ul>
</li>
	<li>autofocus：指定表单获取输入焦点</li>
	<li>list和datalist：为输入框构造一个选择列表
<ul>
	<li>list值为datalist标签的id</li>
</ul>
</li>
	<li>required：此项必填，不能为空</li>
	<li>pattern：正则验证 pattern=”\d{1,5}”</li>
	<li>formaction：在submit里定义提交地址</li>
</ul>
</li>
	<li>表单验证
<ul>
	<li>validity对象，通过下面的valid可以查看验证是否通过，如果八种验证都通过返回true，一种验证失败返回false</li>
	<li>oText.addEventListener(‘invalid’, fn1, false);</li>
	<li>ev.preventDefault()</li>
	<li>valueMissing: 输入值为空时</li>
	<li>typeMismatch: 控件值与预期类型不匹配</li>
	<li>patternMismatch: 输入值不满足pattern正则</li>
	<li>tooLong: 超过maxLength最大限制</li>
	<li>rangeUnderflow: 验证的range最小值</li>
	<li>rangeOverflow: 验证的range最大值</li>
	<li>stepMismatch: 验证range的当前值是否符合min、max及step的规则</li>
	<li>customError 不符合自定义验证
<ul>
	<li>setCustomValidity(); 自定义验证</li>
</ul>
</li>
	<li>invalid事件：验证反馈 input.addEventListener(‘invalid’, fn, false)
<ul>
	<li>阻止默认验证: ev.preventDefault()</li>
</ul>
</li>
	<li>formnovalidate属性：关闭验证</li>
</ul>
</li>
</ul>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
	&lt;meta charset="UTF-8"&gt;
	&lt;title&gt;表单的验证反馈&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;form&gt;
		&lt;input type="text" required id="text" pattern="d{1,5}" maxlength="5"&gt;
		&lt;input type="submit"&gt;
	&lt;/form&gt;
	&lt;script&gt;
		var oText = document.getElementById('text');
		oText.addEventListener('invalid', fn, false);
		function fn(){
			// alert(this.validity);
			// alert(this.validity.valid);
			// alert(this.validity.valueMissing);
			// alert(this.validity.typeMismatch);
			// alert(this.validity.patternMismatch);
			// alert(this.validity.tooLong);
			ev.preventDefault();
		}

		//valueMissing: 当输入值为空时，返回true
		//typeMismatch: 当输入类型和要求的类型不一致时，返回true
		//patternMismatch: 当输入内容和预期的正则是不匹配时，返回true
		//tooLong: 当输入内容的长度超出了maxlength的限制，返回true
	&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
	&lt;meta charset="UTF-8"&gt;
	&lt;title&gt;表单的验证反馈&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;form&gt;
		&lt;input type="text" id="text"&gt;
		&lt;input type="submit"&gt;
	&lt;/form&gt;
	&lt;script&gt;
		var oText = document.getElementById('text');
		oText.addEventListener('invalid', fn, false);
		oText.oninput = function(){
			if(this.value == '敏感词'){
				this.setCustomValidity('请不要输入敏感词');
			} else {
				this.setCustomValidity('');
			}
		}
		function fn(){
			alert(this.validity.customError);
			ev.preventDefault(); 
		}

		//customError: 不符合自定义验证的时候，返回true
	&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
	&lt;meta charset="UTF-8"&gt;
	&lt;title&gt;&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;form action="http://www.baidu.com"&gt;
		&lt;input type="text" placeholder="请输入4—16个字符" name="user" pattern="d{4,16}" required /&gt;
		&lt;input type="submit" value="提交" /&gt;
		&lt;input type="submit" value="保存至草稿箱" formaction="http://www.qq.com" formnovalidate /&gt;
	&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h1 id="html5">HTML5新特性的浏览器支持情况</h1>
<a href="http://www.caniuse.com/#index">http://www.caniuse.com/#index</a>
<h1 id="section-4">新的选择器</h1>
<ul>
	<li>querySelector</li>
	<li>querySelectorAll</li>
	<li>getElementsByClassName</li>
</ul>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
	&lt;meta charset="UTF-8"&gt;
	&lt;title&gt;新的选择器&lt;/title&gt;
	&lt;script&gt;
		// document.getElementById();
		// document.getElementsByTagName();
		//$('#div1') $('.box') $('ul li')

		window.onload = function(){
			//querySelector只能选择到一组元素中的第一个元素
			// var oDiv = document.querySelector('#div1'); //id形式
			// var oDiv = document.querySelector('div'); //标签形式 
			// var oDiv = document.querySelector('.box'); //class形式
			var oDiv = document.querySelector('[title=hello]'); //通过属性值查找
			
			oDiv.style.background = 'red';

			//querySelectorAll 选择到一组元素
			var aDiv = document.querySelectorAll('.box');
			alert(aDiv.length);
			aDiv[1].style.background = "blue";

			var aBox = document.getElementsByClassName('box');
			alert(aBox.length);
		}
	&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;div id="div1" class="box" title="hello"&gt;div&lt;/div&gt;
	&lt;div class="box"&gt;div2&lt;/div&gt;
	&lt;p class="box"&gt;p&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h1 id="class">获取class列表属性</h1>
<ul>
	<li>classList
<ul>
	<li>length: class的长度</li>
	<li>add(): 添加class方法</li>
	<li>remove(): 删除class方法</li>
	<li>toggle(): 切换class方法</li>
</ul>
</li>
</ul>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
	&lt;meta charset="UTF-8"&gt;
	&lt;title&gt;class列表属性&lt;/title&gt;
	&lt;script&gt;
		window.onload = function(){
			var oDiv = document.querySelector('#div1');
			// alert(oDiv.classList); //box1 box2 box3
			// alert(typeof oDiv.classList); //object 类似于数组的对象
			// alert(oDiv.classList.length); //3
			oDiv.classList.add('box4');
			oDiv.classList.remove('box2');
			oDiv.classList.toggle('box3'); //如果原本有box3，就remove；如果没有，就add
		}
	&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;div id="div1" class="box1 box2 box3"&gt;div&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h1 id="json">JSON的新方法</h1>
<ul>
	<li>parse(): 把字符串转成json
<ul>
	<li>字符串中的属性要严格的加上引号</li>
</ul>
</li>
	<li>stringify(): 把json转化成字符串
<ul>
	<li>会自动的把双引号加上</li>
</ul>
</li>
	<li>新方法与eval的区别</li>
	<li>新方法的应用
<ul>
	<li>深度克隆新对象</li>
</ul>
</li>
	<li>如何其他浏览器做到兼容
<ul>
	<li><a href="http://www.json.org/">http://www.json.org</a>去下载json2.js</li>
</ul>
</li>
</ul>
<strong>parse()方法</strong>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
	&lt;meta charset="UTF-8"&gt;
	&lt;title&gt;json的新方法&lt;/title&gt;
	&lt;script&gt;
	/* 用eval
		var str = 'function show(){alert(123)}';
		eval(str); //eval能把字符串转为js
		show();
	*/
	//eval可以解析任何字符串变成JS
	//parse只能解析json形式的字符串变成js （安全性更高一些）

	/* 报错，因为parse转不了function这样的字符串
		var str = 'function show(){alert(123)}';
		JSON.parse(str); //eval能把字符串转为js
		show();
	*/

	/* 报错，这里的name没有加双引号就不行
		var str = '{name: "hello"}';
		var json = JSON.parse(str);
		alert(json.name);
	*/

		var str = '{"name": "hello"}'; //一定是严格的json形式
		var json = JSON.parse(str);
		alert(json.name); //弹出hello
	&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<strong>stringify()方法</strong>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
	&lt;meta charset="UTF-8"&gt;
	&lt;title&gt;json的新方法&lt;/title&gt;
	&lt;script&gt;
		var json = {name: "hello"};
		var str = JSON.stringify(json);
		alert(str); //{"name":"hello"}
	&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<strong>对象拷贝</strong>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
	&lt;meta charset="UTF-8"&gt;
	&lt;title&gt;对象的拷贝&lt;/title&gt;
	&lt;script&gt;
		var a = {
			name: 'hello'
		}

		/*
		//浅拷贝
		var b = {};
		for(var attr in a){
			b[attr] = a[attr];
		}
		*/
	
		//用parse()和stringify()来实现
		

		var str = JSON.stringify(a);
		var b = JSON.parse(str);

		b.name = 'hi';
		alert(a.name); //hello
	&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h1 id="data">data自定义数据</h1>
<ul>
	<li>dataset
<ul>
	<li>data-name: dataset.name</li>
	<li>data-name-first: dataset.nameFirst</li>
</ul>
</li>
	<li>data数据在jQuery Mobile中有着重要作用</li>
</ul>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
	&lt;meta charset="UTF-8"&gt;
	&lt;title&gt;data自定义数据&lt;/title&gt;
	&lt;script&gt;
		window.onload = function(){
			//getAttribute
			
			var oDiv = document.querySelector('#div1');
			alert(oDiv.dataset.miaov);
			alert(oDiv.dataset.miaovAll);
		}
	&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;div id="div1" data-miaov="妙味" data-miaov-all="妙味课堂"&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h1 id="js">延迟加载JS</h1>
<ul>
	<li>JS的加载会影响后面的内容加载
<ul>
	<li>很多浏览器都采用了并行加载JS，但还是会影响其他内容</li>
</ul>
</li>
	<li>HTML5的defer和async
<ul>
	<li>defer: 延迟加载，会按顺序执行，在onload执行前被触发</li>
	<li>async: 异步加载，加载完就触发，有顺序问题</li>
</ul>
</li>
	<li>Labjs库</li>
</ul>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
	&lt;meta charset="UTF-8"&gt;
	&lt;title&gt;JS加载&lt;/title&gt;
	&lt;script src="a.js"&gt;&lt;/script&gt;
	&lt;script src="b.js"&gt;&lt;/script&gt;
	&lt;script src="c.js"&gt;&lt;/script&gt;
	&lt;!-- 解决方法 --&gt;
	&lt;!-- 1. 把script放到body底部 --&gt;
	&lt;!-- 2. 给外部的script添加 defer = "defer" 这个是延迟到onload执行前触发 --&gt;
	&lt;!-- 3. 给script添加 async = "async" 加上异步，就代表是与其他内容并排加载的--&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;!-- 默认上面所有的js都加载完毕之后，再加载img --&gt;
	&lt;img src="1.jpg" alt=""&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h1 id="section-5">历史管理</h1>
<ul>
	<li>触发历史管理：1. 跳转页面；2. hash；3. pushState</li>
	<li>onhashchange: 改变hash值来管理</li>
	<li>history:
<ul>
	<li>服务器下运行</li>
	<li>pushState: 三个参数：数据 标题（都没实现） 地址（可选）</li>
	<li>popstate事件: 读取数据 event.state</li>
	<li>注意：网址是虚假的，需在服务器指定对应页面，不然刷新找不到页面</li>
</ul>
</li>
</ul>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
	&lt;meta charset="UTF-8"&gt;
	&lt;title&gt;彩票&lt;/title&gt;
	&lt;script&gt;
		window.onload = function(){
			var oInput = document.getElementById('input1');
			var oDiv = document.getElementById('div1');

			oInput.onclick = function(){
				var number = randomNum(35, 7);
				oDiv.innerHTML = number;
			}

			function randomNum(all, now){
				var arr = [];
				var newArr = [];
				for(var i=1; i&lt;=all; i++){
					arr.push(i);
				}
				for(var i=0; i&lt;now; i++){
					newArr.push(arr.splice(Math.floor(Math.random()*arr.length), 1));
				}
				return newArr;
			}
		}
	&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;input type="button" value="35选7" id="input1"&gt;
	&lt;div id="div1"&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<strong>采用onhashchange的方法</strong>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
	&lt;meta charset="UTF-8"&gt;
	&lt;title&gt;彩票&lt;/title&gt;
	&lt;script&gt;

		//onhashchange : 事件 当hash值有变化的时候，就会触发
		
		window.onload = function(){
			var oInput = document.getElementById('input1');
			var oDiv = document.getElementById('div1');
			var obj = {};

			oInput.onclick = function(){
				var number = randomNum(35, 7);
				oDiv.innerHTML = number;
				var oRD = Math.random();
				obj[oRD] = number;
				window.location.hash = oRD;
			}

			window.onhashchange = function(){
				var number = obj[window.location.hash.substring(1)] || '';
				oDiv.innerHTML = number;
			}

			function randomNum(all, now){
				var arr = [];
				var newArr = [];
				for(var i=1; i&lt;=all; i++){
					arr.push(i);
				}
				for(var i=0; i&lt;now; i++){
					newArr.push(arr.splice(Math.floor(Math.random()*arr.length), 1));
				}
				return newArr;
			}
		}
	&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;input type="button" value="35选7" id="input1"&gt;
	&lt;div id="div1"&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<strong>用html5的history对象来实现</strong>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
	&lt;meta charset="UTF-8"&gt;
	&lt;title&gt;彩票&lt;/title&gt;
	&lt;script&gt;
		window.onload = function(){
			var oInput = document.getElementById('input1');
			var oDiv = document.getElementById('div1');
			var iNow = 1;

			oInput.onclick = function(){
				var number = randomNum(35, 7);
				oDiv.innerHTML = number;
				history.pushState(number, '', iNow++);
			}

			window.onpopstate = function(ev){
				var number = ev.state || '';
				oDiv.innerHTML = number;
			}

			function randomNum(all, now){
				var arr = [];
				var newArr = [];
				for(var i=1; i&lt;=all; i++){
					arr.push(i);
				}
				for(var i=0; i&lt;now; i++){
					newArr.push(arr.splice(Math.floor(Math.random()*arr.length), 1));
				}
				return newArr;
			}
		}
	&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;input type="button" value="35选7" id="input1"&gt;
	&lt;div id="div1"&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h1 id="section-6">拖放事件</h1>
<ul>
	<li>draggable:
<ul>
	<li>设置为true，元素就可以拖拽了</li>
</ul>
</li>
	<li>拖拽元素事件：事件对象为被拖拽元素
<ul>
	<li>dragstart，拖拽前触发</li>
	<li>drag，拖拽前、拖拽结束之间，连续触发(不管鼠标是否在移动)</li>
	<li>dragend，拖拽结束触发</li>
</ul>
</li>
	<li>目标元素事件：事件对象为目标元素
<ul>
	<li>dragenter，进入目标元素触发，相当于mouseover</li>
	<li>dragover，进入目标、离开目标之间，连续触发(不管鼠标是否在移动)</li>
	<li>dragleave，离开目标元素触发，相当于mouseout</li>
	<li>drop，在目标元素上释放鼠标触发</li>
</ul>
</li>
	<li>事件的执行顺序：drop不触发的时候
<ul>
	<li>dragstart -&gt; drag -&gt; dragenter -&gt; dragover -&gt; dragleave -&gt; dragend</li>
</ul>
</li>
	<li>事件的执行顺序：drop触发的时候（dragover的时候阻止默认事件）
<ul>
	<li>dragstart -&gt; drag -&gt; dragenter -&gt; dragover -&gt; drop -&gt; dragend</li>
</ul>
</li>
	<li>不能释放的光标和能释放的光标不一样</li>
</ul>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
	&lt;meta charset="UTF-8"&gt;
	&lt;title&gt;拖放操作&lt;/title&gt;
	&lt;style&gt;
		li {width: 100px; height: 30px; background: yellow; margin: 10px; list-style: none;}
		#div1 {width: 100px; height: 100px; background: red; margin: 200px;}
	&lt;/style&gt;
	&lt;script&gt;
		window.onload = function(){
			var aLi = document.querySelectorAll('li');
			var oDiv = document.querySelector('#div1');
			var i = 0;

			for(var i=0; i&lt;aLi.length; i++){
				aLi[i].ondragstart = function(){
					this.style.background = 'green';
				}

				aLi[i].ondrag = function(){
					// document.title = i++;
				}

				aLi[i].ondragend = function(){
					this.style.background = 'yellow';
				}
			}

			oDiv.ondragenter = function(){
				this.style.background = 'blue';
			}
			
			oDiv.ondragover = function(ev){
				// document.title = i++;
				// 要想触发drop事件，就必须在dragover当中阻止默认事件
				var ev = ev || window.event;
				ev.preventDefault();
			}

			oDiv.ondragleave = function(){
				this.style.background = 'red';
			}

			oDiv.ondrop = function(){
				alert(123);
			}
		}
	&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;ul&gt;
		&lt;li draggable="true"&gt;a&lt;/li&gt;
		&lt;li draggable="true"&gt;b&lt;/li&gt;
		&lt;li draggable="true"&gt;c&lt;/li&gt;
	&lt;/ul&gt;
	&lt;div id="div1"&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<ul>
	<li>解决火狐下的问题
<ul>
	<li>必须设置dataTransfer对象才可以拖拽除图片外的其他标签</li>
</ul>
</li>
	<li>dataTransfer对象（该对象是event对象下的）
<ul>
	<li>setData(): 设置数据 key和value （必须是字符串）</li>
	<li>getData(): 获取数据，根据key值，获取对应的value</li>
	<li>effectAllowed
<ul>
	<li>effectAllowed: 设置光标样式(none, copy, copyLink, copyMove, link, linkMove, move, all和uninitialized)</li>
</ul>
</li>
	<li>setDragImage
<ul>
	<li>三个参数：指定的元素或图片，坐标X，坐标Y</li>
</ul>
</li>
	<li>files
<ul>
	<li>获取外部拖拽的文件，返回一个filesList列表</li>
	<li>filesList下有个type属性，返回文件的类型</li>
</ul>
</li>
	<li>FileReader对象（读取文件信息）
<ul>
	<li>readAsDataURL
<ul>
	<li>参数为要读取的文件对象，将文件读取为DataURL</li>
</ul>
</li>
	<li>onload
<ul>
	<li>当读取文件成功完成的时候触发此事件</li>
	<li>this.result，来获取读取的文件数据，如果是图片，将返回base64格式的图片数据</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
	<li>实例
<ul>
	<li>拖拽删除列表</li>
	<li>拖拽购物车</li>
	<li>上传图片预览功能</li>
</ul>
</li>
</ul>
<strong>实现火狐下的拖拽</strong>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
	&lt;meta charset="UTF-8"&gt;
	&lt;title&gt;拖放操作——解决火狐的问题&lt;/title&gt;
	&lt;style&gt;
		li {width: 100px; height: 30px; background: yellow; margin: 10px; list-style: none;}
		#div1 {width: 100px; height: 100px; background: red; margin: 200px;}
	&lt;/style&gt;
	&lt;script&gt;
		window.onload = function(){
			var aLi = document.querySelectorAll('li');
			var oDiv = document.querySelector('#div1');
			var i = 0;

			for(var i=0; i&lt;aLi.length; i++){
				aLi[i].ondragstart = function(ev){
					var ev = ev || window.event;
					ev.dataTransfer.setData('name', 'hello'); //火狐下面的操作 设置过这个就可以拖放了
					this.style.background = 'green';
				}

				aLi[i].ondrag = function(){
					// document.title = i++;
				}

				aLi[i].ondragend = function(){
					this.style.background = 'yellow';
				}
			}

			oDiv.ondragenter = function(){
				this.style.background = 'blue';
			}
			
			oDiv.ondragover = function(ev){
				// document.title = i++;
				// 要想触发drop事件，就必须在dragover当中阻止默认事件
				var ev = ev || window.event;
				ev.preventDefault();
			}

			oDiv.ondragleave = function(){
				this.style.background = 'red';
			}

			oDiv.ondrop = function(ev){
				var ev = ev || window.event;
				alert(ev.dataTransfer.getData('name')); //可以setData就可以getData
				alert(123);
			}
		}
	&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;ul&gt;
		&lt;li draggable="true"&gt;a&lt;/li&gt;
		&lt;li draggable="true"&gt;b&lt;/li&gt;
		&lt;li draggable="true"&gt;c&lt;/li&gt;
	&lt;/ul&gt;
	&lt;div id="div1"&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<strong>拖拽删除列表</strong>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
	&lt;meta charset="UTF-8"&gt;
	&lt;title&gt;拖拽删除列表&lt;/title&gt;
	&lt;style&gt;
		li {width: 100px; height: 30px; background: yellow; margin: 10px; list-style: none;}
		#div1 {width: 100px; height: 100px; background: red; margin: 200px;}
	&lt;/style&gt;
	&lt;script&gt;
		window.onload = function(){
			var aLi = document.querySelectorAll('li');
			var oDiv = document.querySelector('#div1');
			var oUl = document.querySelector('#ul1')
			var i = 0;

			for(var i=0; i&lt;aLi.length; i++){
				aLi[i].index = i;
				aLi[i].ondragstart = function(ev){
					var ev = ev || window.event;
					ev.dataTransfer.setData('name', this.index);
					this.style.background = 'green';
				}

				aLi[i].ondrag = function(){
					// document.title = i++;
				}

				aLi[i].ondragend = function(){
					this.style.background = 'yellow';
				}
			}

			oDiv.ondragenter = function(){
				this.style.background = 'blue';
			}
			
			oDiv.ondragover = function(ev){
				// document.title = i++;
				// 要想触发drop事件，就必须在dragover当中阻止默认事件
				var ev = ev || window.event;
				ev.preventDefault();
			}

			oDiv.ondragleave = function(){
				this.style.background = 'red';
			}

			oDiv.ondrop = function(ev){
				var ev = ev || window.event;
				oUl.removeChild(aLi[ev.dataTransfer.getData('name')]);
				for(var i=0; i&lt;aLi.length; i++){
					aLi[i].index = i;
				}
			}
		}
	&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;ul id="ul1"&gt;
		&lt;li draggable="true"&gt;a&lt;/li&gt;
		&lt;li draggable="true"&gt;b&lt;/li&gt;
		&lt;li draggable="true"&gt;c&lt;/li&gt;
	&lt;/ul&gt;
	&lt;div id="div1"&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<strong>effectAllowed和setDragImage</strong>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
	&lt;meta charset="UTF-8"&gt;
	&lt;title&gt;拖放操作——effectAllowed和setDragImage&lt;/title&gt;
	&lt;style&gt;
		li {width: 100px; height: 30px; background: yellow; margin: 10px; list-style: none;}
		#div1 {width: 100px; height: 100px; background: red; margin: 200px;}
	&lt;/style&gt;
	&lt;script&gt;
		window.onload = function(){
			var aLi = document.querySelectorAll('li');
			var oDiv = document.querySelector('#div1');
			var oUl = document.querySelector('#ul1');
			var oImg = document.querySelector('img');
			var i = 0;

			for(var i=0; i&lt;aLi.length; i++){
				aLi[i].ondragstart = function(ev){
					var ev = ev || window.event;
					ev.dataTransfer.setData('name', 'hello');
					ev.dataTransfer.effectAllowed = 'link';
					ev.dataTransfer.setDragImage(oImg, 0, 0);
					
				}

				aLi[i].ondrag = function(){
				}

				aLi[i].ondragend = function(){
					this.style.background = 'yellow';
				}
			}

			oDiv.ondragenter = function(){
				this.style.background = 'blue';
			}
			
			oDiv.ondragover = function(ev){
				var ev = ev || window.event;
				ev.preventDefault();
			}

			oDiv.ondragleave = function(){
				this.style.background = 'red';
			}

			oDiv.ondrop = function(ev){
				
			}
		}
	&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;ul id="ul1"&gt;
		&lt;li draggable="true"&gt;a&lt;/li&gt;
		&lt;li draggable="true"&gt;b&lt;/li&gt;
		&lt;li draggable="true"&gt;c&lt;/li&gt;
	&lt;/ul&gt;
	&lt;div id="div1"&gt;&lt;/div&gt;
	&lt;img src="img/ppt.gif" style="display: none;"&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<strong>拖放外部文件</strong>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
	&lt;meta charset="UTF-8"&gt;
	&lt;title&gt;拖放操作——拖放外部文件&lt;/title&gt;
	&lt;style&gt;
		#div1 {width: 200px; height: 200px; background: red; margin: 100px;}
	&lt;/style&gt;
	&lt;script&gt;
		window.onload = function(){
			var oDiv = document.querySelector('#div1');
			var oImg = document.querySelector('img');
			var i = 0;

			oDiv.ondragenter = function(){
				this.innerHTML = '可以释放啦';
			}
			
			oDiv.ondragover = function(ev){
				var ev = ev || window.event;
				ev.preventDefault();
			}

			oDiv.ondragleave = function(){
				this.innerHTML = '将文件拖拽到此区域';
			}

			oDiv.ondrop = function(ev){
				var ev = ev || window.event;
				ev.preventDefault();
				var fs = ev.dataTransfer.files;
				// alert(fs); //object Filelist
				// alert(fs.length);
				// alert(fs[0].type); //文件类型
				var fd = new FileReader();
				fd.readAsDataURL(fs[0]);
				fd.onload = function(){ //上面文件信息读取成功之后就会走这个onload
					alert(this.result);
				}
			}
		}
	&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;div id="div1"&gt;将文件拖拽到此区域&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<strong>图片预览功能</strong>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
	&lt;meta charset="UTF-8"&gt;
	&lt;title&gt;图片预览&lt;/title&gt;
	&lt;style&gt;
		#div1 {width: 200px; height: 200px; background: red; margin: 100px;}
	&lt;/style&gt;
	&lt;script&gt;
		window.onload = function(){
			var oDiv = document.querySelector('#div1');
			var oUl = document.getElementById('ul1')
			var oImg = document.querySelector('img');
			var i = 0;

			oDiv.ondragenter = function(){
				this.innerHTML = '可以释放啦';
			}
			
			oDiv.ondragover = function(ev){
				var ev = ev || window.event;
				ev.preventDefault();
			}

			oDiv.ondragleave = function(){
				this.innerHTML = '将文件拖拽到此区域';
			}

			oDiv.ondrop = function(ev){
				var ev = ev || window.event;
				ev.preventDefault();
				var fs = ev.dataTransfer.files;
				/*if(fs[0].type.indexOf('image') != -1){
					var fd = new FileReader();
					fd.readAsDataURL(fs[0]);
					fd.onload = function(){ 
						var oLi = document.createElement('li');
						var oImg = document.createElement('img');
						oImg.src = this.result;
						oLi.appendChild(oImg);
						oUl.appendChild(oLi);
					}
				} else {
					alert('亲，请上传图片类型！');
				}	*/
				for(var i=0; i&lt;fs.length; i++){
					if(fs[i].type.indexOf('image') != -1){
						var fd = new FileReader();
						fd.readAsDataURL(fs[i]);
						fd.onload = function(){ 
							var oLi = document.createElement('li');
							var oImg = document.createElement('img');
							oImg.src = this.result;
							oLi.appendChild(oImg);
							oUl.appendChild(oLi);
						}
					} else {
						alert('亲，请上传图片类型！');
					}
				}
			}
		}
	&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;div id="div1"&gt;将文件拖拽到此区域&lt;/div&gt;
	&lt;ul id="ul1"&gt;&lt;/ul&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<strong>拖拽购物车</strong>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
	&lt;meta charset="UTF-8"&gt;
	&lt;title&gt;拖拽购物车&lt;/title&gt;
	&lt;style&gt;
		* {margin: 0; padding: 0;}
		li {list-style: none;}
		li {float: left; width: 200px; border: 1px solid #000; margin: 10px;}
		li img {width: 200px;}
		p {border-bottom: 1px dashed #333; height: 20px;}
		#div1 {width: 600px; border: 1px solid #000; height: 300px; clear: both;}
		.box1 {float: left; width: 200px;}
		.box2 {float: left; width: 200px;}
		.box3 {float: left; width: 200px;}
		#allMoney {float: right;}
	&lt;/style&gt;
	&lt;script&gt;
		window.onload = function(){
			var aLi = document.getElementsByTagName('li');
			var oDiv = document.getElementById('div1');
			var obj = {};
			var iNum = 0;
			var allMoney = null;

			for(var i=0; i&lt;aLi.length; i++){
				aLi[i].ondragstart = function(ev){
					var aP = this.getElementsByTagName('p');
					var ev = ev || window.event;
					ev.dataTransfer.setData('title', aP[0].innerHTML);
					ev.dataTransfer.setData('money', aP[1].innerHTML);
					ev.dataTransfer.setDragImage(this, 0, 0);
				}
			}

			oDiv.ondragover = function(ev){
				ev.preventDefault();
			}

			oDiv.ondrop = function(ev){
				ev.preventDefault();

				var sTitle = ev.dataTransfer.getData('title');
				var sMoney = ev.dataTransfer.getData('money');

				if(!obj[sTitle]){
					var oP = document.createElement('p');
					var oSpan = document.createElement('span');
					oSpan.className = 'box1';
					oSpan.innerHTML = 1;
					oP.appendChild(oSpan);
					var oSpan = document.createElement('span');
					oSpan.className = 'box2';
					oSpan.innerHTML = sTitle;
					oP.appendChild(oSpan);
					var oSpan = document.createElement('span');
					oSpan.className = 'box3';
					oSpan.innerHTML = sMoney;
					oP.appendChild(oSpan);

					oDiv.appendChild(oP);

					obj[sTitle] = 1;
				} else {
					var box1 = document.getElementsByClassName('box1');
					var box2 = document.getElementsByClassName('box2');

					for(var i=0; i&lt;box2.length; i++){
						if(box2[i].innerHTML == sTitle){
							box1[i].innerHTML = parseInt(box1[i].innerHTML) + 1;
						}
					}
				}

				if(!allMoney){
					allMoney = document.createElement('div');
					allMoney.id = 'allMoney';
				}
				iNum += parseInt(sMoney.substring(1));
				allMoney.innerHTML = '￥' + iNum;
				oDiv.appendChild(allMoney);
			}
		}
	&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;ul&gt;
		&lt;li draggable="true"&gt;
			&lt;img src="images/1.png"&gt;
			&lt;p&gt;javascript语言精粹&lt;/p&gt;
			&lt;p&gt;￥40&lt;/p&gt;
		&lt;/li&gt;
		&lt;li draggable="true"&gt;
			&lt;img src="images/2.png"&gt;
			&lt;p&gt;javascript权威指南&lt;/p&gt;
			&lt;p&gt;￥120&lt;/p&gt;
		&lt;/li&gt;
		&lt;li draggable="true"&gt;
			&lt;img src="images/3.png"&gt;
			&lt;p&gt;精通javascript&lt;/p&gt;
			&lt;p&gt;￥35&lt;/p&gt;
		&lt;/li&gt;
		&lt;li draggable="true"&gt;
			&lt;img src="images/4.png"&gt;
			&lt;p&gt;DOM编程艺术&lt;/p&gt;
			&lt;p&gt;￥45&lt;/p&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;div id="div1"&gt;
		&lt;!-- &lt;p&gt;
			&lt;span class="box1"&gt;1&lt;/span&gt;
			&lt;span class="box2"&gt;DOM编程艺术&lt;/span&gt;
			&lt;span class="box3"&gt;￥45&lt;/span&gt;
		&lt;/p&gt;
		&lt;p&gt;
			&lt;span class="box1"&gt;1&lt;/span&gt;
			&lt;span class="box2"&gt;DOM编程艺术&lt;/span&gt;
			&lt;span class="box3"&gt;￥45&lt;/span&gt;
		&lt;/p&gt;
		&lt;div id="allMoney"&gt;￥90&lt;/div&gt; --&gt;
	&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h1 id="section-7">跨文档消息通信</h1>
<h2 id="postmessage">postMessage对象</h2>
<ul>
	<li>接收消息的窗口对象 .postMessage()</li>
	<li>一参 : 发送的数据；二参 : 接收的域</li>
	<li>交互方式
<ul>
	<li>iframe : 父页面 : contentWindow、子页面 : window.top （parent =&gt; window 如果子页面的parent页面是顶级，没有被其他页面所包含，那么parent就是当前页面的window对象；如果被包含了，则parent就是包含当前页面的父级页面的window对象。window：当前窗口；parent：父级窗口；top：顶级窗口）</li>
	<li>窗口页 : 父页面 : window.open、子页面 : window.opener</li>
</ul>
</li>
	<li>接收事件
<ul>
	<li>message</li>
	<li>ev.origin : 发送数据来源的域</li>
	<li>ev.data : 发送的数据</li>
</ul>
</li>
	<li>同域下多窗口之间的通信可以采用以下方法：
<ul>
	<li>iframe 我们可以通过js去访问被包含页面的DOM元素</li>
	<li>window.open</li>
</ul>
</li>
</ul>
<strong>通过iframe进行窗口间通信(同域)</strong>
<pre><code class="language-html">&lt;!DOCTYPE HTML&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"&gt;
&lt;title&gt;&lt;/title&gt;
&lt;script&gt;
/*
我们可以通过js去访问被包含页面的DOM元素
*/
window.onload = function() {
	
	var oBtn = document.getElementById('btn');
	var oMyIframe = document.getElementById('myframe');
	
	oBtn.onclick = function() {
		
		//如果我们要操作一个iframe里面的dom元素，首先要获取到iframe引入的页面的window
		//oMyIframe.contentWindow -&gt; 被iframe包含的页面的window对象
		//alert(oMyIframe.contentWindow);
		
		oMyIframe.contentWindow.document.body.style.background = 'red';
	}
}
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;
	&lt;input type="button" value="点击我，改变2.iframe.html的背景色" id="btn" /&gt;
	&lt;iframe id="myframe" src="2.iframe.html"&gt;&lt;/iframe&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<strong>通过window.open来进行窗口间通信（同域）</strong>
<pre><code class="language-html">&lt;!DOCTYPE HTML&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"&gt;
&lt;title&gt;无标题文档&lt;/title&gt;
&lt;script&gt;
window.onload = function() {
	
	var oBtn = document.getElementById('btn');
	var oBtn2 = document.getElementById('btn2');
	var newWindow = null;
	
	oBtn.onclick = function() {
		//window.open 返回被打开窗口的window对象
		newWindow = window.open('4.window.open.html', '_blank');	
	}
	
	oBtn2.onclick = function() {
		newWindow.document.body.style.background = 'red';
	}
}
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;
	&lt;input type="button" value="点击我，开启一个新的窗口打开4.window.open.html页面" id="btn" /&gt;
    &lt;input type="button" value="点击我，改变4.window.open.html页面的背景色" id="btn2" /&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<strong>通过postMessage进行跨域的窗口通信 发送消息</strong>
<pre><code class="language-html">&lt;!DOCTYPE HTML&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"&gt;
&lt;title&gt;无标题文档&lt;/title&gt;
&lt;script&gt;
window.onload = function() {
	
	var oBtn = document.getElementById('btn');
	var oMyIframe = document.getElementById('myframe');
	
	/*
		postMessage : 可以通过这个方法给另外一个窗口发送信息
		
		接收消息的窗口的window对象.postMessage();
	*/
	
	oBtn.onclick = function() {
		
		//当本页面和包含页面不在同一个域名下的时候，这样操作就会有跨域操作安全限制问题。
		
		//oMyIframe.contentWindow.document.body.style.background = 'red';
		
		/*
		第一个参数：发送的数据
		第二个参数：接收数据的域名｛带上协议｝
		*/
		
		oMyIframe.contentWindow.postMessage('1', 'http://www.b.com');
		//alert(oMyIframe.contentWindow.postMessage)
		
	}
	
}
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;
	&lt;input type="button" value="点击我，改变2.iframe.html的背景色" id="btn" /&gt;
	&lt;iframe id="myframe" src="http://www.b.com/3.postMessage.html"&gt;&lt;/iframe&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<strong>通过message接收postMessage发来的信息</strong>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
	&lt;meta charset="UTF-8"&gt;
	&lt;title&gt;&lt;/title&gt;
	&lt;script&gt;
	window.onload = function(){
		/*
		message: 当窗口接收到通过postMessage发送过来的数据的时候触发
		 */
		
		window.addEventListener('message', function(ev){
			//alert('b.com下的页面接受到了内容了')
			
			//message事件的事件对象保存了发送过来的内容
			//ev.data: 发送过来的数据
			//ev.origin: 发送消息的来源域
			
			//alert('我接受到了a.com页面发送过来的数据，内容是：'+ ev.data)
			//alert(ev.origin);
			
			if(ev.origin == 'www.a.com' &amp;&amp; ev.data == '1'){
				document.body.style.background = 'red';
			}
		}, false);
	}
	&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
	这是b.com的potMessage.html页面
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h2 id="xmlhttprequest-level-2">XMLHttpRequest Level 2</h2>
<ul>
	<li>XMLHttpRequest 改进版
<ul>
	<li>请求页面与数据页面必须属于不同的域</li>
	<li>服务器要设置响应头信息 header(‘Access-Control-Allow-origin:http://www.a.com’) （注意，这里的a.com是可以更改的。这句话的意思就是允许访问该资源的域为http://www.a.com，注意带协议）</li>
	<li>Origin值展现</li>
	<li>IE : XDomainRequest</li>
	<li>新的事件 : onload等</li>
	<li><a href="http://www.w3.org/TR/XMLHttpRequest2">http://www.w3.org/TR/XMLHttpRequest2</a></li>
	<li><a href="http://msdn.microsoft.com/en-us/library/cc288060(V5.85).aspx">http://msdn.microsoft.com/en-us/library/cc288060(V5.85).aspx</a></li>
</ul>
</li>
	<li>进度事件
<ul>
	<li>upload : 上传</li>
	<li>FormData对象</li>
	<li>ev.total(已发送的总量)、ev.loaded(待发送的总量)</li>
	<li>onprogress事件</li>
</ul>
</li>
</ul>
<strong>Ajax获取同域下的内容</strong>
<pre><code class="language-html">&lt;!DOCTYPE HTML&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"&gt;
&lt;title&gt;无标题文档&lt;/title&gt;
&lt;script&gt;
window.onload = function() {
	
	var oBtn = document.getElementById('btn');
	
	oBtn.onclick = function() {
		
		var xhr = new XMLHttpRequest();
		xhr.onreadystatechange = function() {
			if (xhr.readyState == 4) {
				if (xhr.status == 200) {
					alert(xhr.responseText);
				}
			}
		}
		xhr.open('get', 'ajax.php', true);
		xhr.send();
		
	}
	
}
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;
	&lt;input type="button" value="获取同域下内容" id="btn" /&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<strong>IE下的跨域请求</strong>
<pre><code class="language-html">&lt;!DOCTYPE HTML&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"&gt;
&lt;title&gt;无标题文档&lt;/title&gt;
&lt;script&gt;
window.onload = function() {
	
	/*
	在标准浏览器下，XMLHttpRequest对象已经是升级版本，支持了更多的特性，可以跨域了
	但是，如果想实现跨域请求，还需要后端的相关配合才可以
	
	XMLHttpRequest : 增加很多功能，他也不推荐使用onreadystatechange这个事件来监听，推荐使用onload
	
	XDomainRequest : IE如果想实现跨域请求，则需要使用另外一个对象去实现
	*/
	var oBtn = document.getElementById('btn');
	
	oBtn.onclick = function() {
		
		/*var xhr = new XMLHttpRequest();
		xhr.onreadystatechange = function() {
			if (xhr.readyState == 4) {
				if (xhr.status == 200) {
					alert(xhr.responseText);
				}
			}
		}
		xhr.open('get', 'http://www.b.com/ajax.php', true);
		xhr.send();*/
		
		var oXDomainRequest = new XDomainRequest();
		oXDomainRequest.onload = function() {
			alert(this.responseText);
		}
		oXDomainRequest.open('get', 'http://www.b.com/ajax.php', true);
		oXDomainRequest.send();		
	}	
}
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;
	&lt;input type="button" value="获取同域下内容" id="btn" /&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<strong>Ajax实现无刷新上传</strong>
<pre><code class="language-html">&lt;!DOCTYPE HTML&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"&gt;
&lt;title&gt;无标题文档&lt;/title&gt;
&lt;style&gt;
#div1 {width: 300px; height: 30px; border: 1px solid #000; position: relative;}
#div2 {width: 0; height: 30px; background: #CCC;}
#div3 {width: 300px; height: 30px; line-height: 30px; text-align: center; position: absolute; left: 0; top: 0;}
&lt;/style&gt;
&lt;script&gt;
window.onload = function() {
	
	var oBtn = document.getElementById('btn');
	var oMyFile = document.getElementById('myFile');
	var oDiv1 = document.getElementById('div1');
	var oDiv2 = document.getElementById('div2');
	var oDiv3 = document.getElementById('div3');
	
	oBtn.onclick = function() {
		
		//alert(oMyFile.value);	//获取到的是file控件的value值，这个内容是显示给你看的文字，不是我们选择的文件
		
		//oMyFile.files file控件中选择的文件列表对象
		//alert(oMyFile.files);
		
		//我们是要通过ajax把oMyFile.files[0]数据发送给后端
		
		/*for (var attr in oMyFile.files[0]) {
			console.log( attr + ' : ' + oMyFile.files[0][attr] );
		}*/
		
		var xhr = new XMLHttpRequest();
		
		xhr.onload = function() {
			//alert(1);
			//var d = JSON.parse(this.responseText);
			
			//alert(d.msg + ' : ' + d.url);
			
			alert('OK,上传完成');
		}
		
		//alert(xhr.upload);
		var oUpload = xhr.upload;
		//alert(oUpload);
		oUpload.onprogress  = function(ev) {
			console.log(ev.total + ' : ' + ev.loaded);
			
			var iScale = ev.loaded / ev.total;
			
			oDiv2.style.width = 300 * iScale + 'px';
			oDiv3.innerHTML = iScale * 100 + '%';
			
		}
		
		xhr.open('post', 'post_file.php', true);
		xhr.setRequestHeader('X-Request-With', 'XMLHttpRequest');
		
		var oFormData = new FormData();	//通过FormData来构建提交数据
		oFormData.append('file', oMyFile.files[0]);
		xhr.send(oFormData);
		
	}
	
}
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;
	&lt;input type="file" id="myFile" /&gt;&lt;input type="button" id="btn" value="上传" /&gt;
    &lt;div id="div1"&gt;
    	&lt;div id="div2"&gt;&lt;/div&gt;
        &lt;div id="div3"&gt;0%&lt;/div&gt;
    &lt;/div&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<strong>form的上传方式</strong>
<pre><code class="language-html">&lt;!DOCTYPE HTML&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"&gt;
&lt;title&gt;无标题文档&lt;/title&gt;
&lt;/head&gt;

&lt;body&gt;
	&lt;form method="post" action="post_file.php" enctype="multipart/form-data"&gt;
    	&lt;input type="file" name="file" /&gt;
        &lt;input type="submit" value="上传" /&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h2 id="websocket">websocket</h2>
<ul>
	<li>互联网协议</li>
	<li><a href="http://www.ruanyifeng.com/blog/2012/05/internet_protocol_suite_part_i.html">http://www.ruanyifeng.com/blog/2012/05/internet_protocol_suite_part_i.html</a></li>
	<li>TCP/IP协议
<ul>
	<li>定义了电子设备如何连入因特网，以及数据在它们之间传输的标准（如何传输）</li>
	<li>传输数据（协议）类型：Email、www、FTP等</li>
</ul>
</li>
	<li>HTTP协议
<ul>
	<li>浏览器和万维网服务器之间互相通信的规则</li>
</ul>
</li>
	<li>HTTP协议的特点
<ul>
	<li>功能很强大</li>
	<li>采用请求、响应模式，单向通信</li>
	<li>短连接，响应完成连接就断开</li>
</ul>
</li>
	<li>实时web交互
<ul>
	<li>股票、聊天室、网游等应用</li>
	<li>如何实现实时应用？服务器推送</li>
</ul>
</li>
	<li>什么是web socket？
<ul>
	<li>基于TCP的双向的、全双工的数据连接
<ul>
	<li>双向的：客户端、服务器端</li>
	<li>全双工：数据的发送与接收，两者同步进行</li>
</ul>
</li>
	<li>建立socket应用？
<ul>
	<li>服务器必须支持web socket</li>
	<li>Nodejs的简介
<ul>
	<li>Ryan Dahl基于Google V8引擎创造的一套用来编写高性能网络服务器的ECMAScript工具包</li>
</ul>
</li>
	<li>Nodejs：用js去写服务器应用</li>
</ul>
</li>
</ul>
</li>
	<li>Node.js
<ul>
	<li>安装node.js</li>
	<li>转到项目目录</li>
	<li>运行node scriptname.js</li>
	<li>http服务器的创建</li>
	<li>安装websocket模块 npm install socket.io</li>
	<li>websocket服务的创建</li>
</ul>
</li>
</ul>
<pre><code class="language-js">var http = require('http');

var serv = http.createServer(function(req, res) {
	
	console.log('有人进来了');
	
	/*res.writeHeader(200, {
		'content-type' : 'text/html;charset="utf-8"'
	});*/
	
	/*res.writeHeader(404, {
		'content-type' : 'text/html;charset="utf-8"'
	});
	
	res.write('你要访问的页面资源不存在！');
	res.end();*/
	
	console.log(req);
	
}).listen(8888);

console.log('服务器开启成功');
</code></pre>
<pre><code class="language-js">var http = require('http');
var fs = require('fs');

var documentRoot = 'E:/HTML5/websocket/www';

var httpServer = http.createServer(function(req, res) {
	
	var url = req.url;
	//console.log(url);
	
	var file = documentRoot + url;
	console.log(file);
	
	fs.readFile(file, function(err, data) {
		
		if (err) {
			res.writeHeader(404, {
				'content-type' : 'text/html;charset="utf-8"'
			});
			res.write('&lt;h1&gt;404&lt;/h1&gt;&lt;p&gt;你要找的页面被LEO吃了&lt;/p&gt;');
			res.end();
		} else {
			res.writeHeader(200, {
				'content-type' : 'text/html;charset="utf-8"'
			});
			res.write(data);
			res.end();
		}
		
	});
	
}).listen(8888);
</code></pre>
<pre><code class="language-js">var http = require('http');
var fs = require('fs');
var io = require('socket.io');

var documentRoot = 'E:/HTML5/websocket/www';

var httpServer = http.createServer(function(req, res) {
	
	var url = req.url;
	//console.log(url);
	
	var file = documentRoot + url;
	console.log(file);
	
	fs.readFile(file, function(err, data) {
		
		if (err) {
			res.writeHeader(404, {
				'content-type' : 'text/html;charset="utf-8"'
			});
			res.write('&lt;h1&gt;404&lt;/h1&gt;&lt;p&gt;你要找的页面被LEO吃了&lt;/p&gt;');
			res.end();
		} else {
			res.writeHeader(200, {
				'content-type' : 'text/html;charset="utf-8"'
			});
			res.write(data);
			res.end();
		}
		
	});
	
}).listen(8888);

var socket = io.listen(httpServer);

socket.sockets.on('connection', function(socket) {
	
	//socket
	
	//console.log('有人通过socket连接进来了');
	
	socket.emit('hello', '欢迎');
	
	/*socket.on('hellotoo', function(data) {
		console.log(data);
	})*/

	
	//socket.broadcast.emit('a');
	
	socket.broadcast.emit('a', '有新人进来了');
	
	socket.on('move', function(data) {
		
		socket.broadcast.emit('move2', data);

	});
	
});
</code></pre>
<h1 id="html5applicationcache">HTML5的离线存储（applicationCache）</h1>
<ul>
	<li>离线应用是什么
<ul>
	<li>乘坐飞机、手机信号弱；去演讲的时候，可能没有网络，这个时候就可以采用离线应用</li>
	<li>离线存储如何工作的？</li>
</ul>
</li>
	<li>离线存储的好处
<ul>
	<li>没网的时候，可以正常访问</li>
	<li>快速响应页面，不必用多个HTTP占用资源带宽</li>
	<li>缓存的可以是任何文件</li>
</ul>
</li>
</ul>
<h2 id="section-8">搭建离线应用程序</h2>
<ul>
	<li>① 服务器设置头信息：
<ul>
	<li>AddType text/cache-manifest.manifest</li>
</ul>
</li>
	<li>② html标签加：
<ul>
	<li>manifest=”xxxxx.manifest”</li>
</ul>
</li>
	<li>③ 写manifest文件：离线的清单列表
<ul>
	<li>先写：CACHE MANIFEST</li>
	<li>FALLBACK：第一个网络地址没获取到，就走第二个缓存的</li>
	<li>NETWORK：无论缓存中存在与否，均从网络获取</li>
</ul>
</li>
</ul>
<strong>manifest文件</strong>
<pre><code>CACHE MANIFEST

2.png
1.jpg

FALLBACK

style1.css style2.css

NETWORK

a.jpg
</code></pre>
<h1 id="web-workers">Web Workers</h1>
<ul>
	<li>什么是worker
<ul>
	<li>JS的单线程（放入UI队列的个数，利用定时器解决）</li>
	<li>可以让web应用程序具备后台处理能力，对多线程的支持非常好</li>
</ul>
</li>
	<li>Worker API
<ul>
	<li>new Worker(‘后台处理的JS地址’)</li>
	<li>利用postMessage传输数据</li>
	<li>importScripts(‘导入其他JS文件’)</li>
</ul>
</li>
	<li>Worker运行环境
<ul>
	<li>navagator: appName、appVersion、userAgent、platform</li>
	<li>location: 所有属性都是只读的</li>
	<li>self: 指向全局的worker对象</li>
	<li>所有的ECMA对象：Object、Array、Date等</li>
	<li>XMLHttpRequest构造器</li>
	<li>setTimeout和setInterval方法</li>
	<li>close()方法，立刻停止worker运行</li>
	<li>importScripts方法：引入其他线程文件</li>
</ul>
</li>
</ul>
<strong>Web Worker简单应用</strong>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
	&lt;meta charset="UTF-8"&gt;
	&lt;title&gt;Web Worker&lt;/title&gt;
	&lt;script type="text/javascript"&gt;
		var w1 = new Worker('test.js');
		w1.postMessage('hi');
		w1.onmessage = function(ev){
			alert(ev.data);
		}
	&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
	
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<pre><code class="language-js">//test.js

self.onmessage = function(ev){ //这里的self就是指自己本身，也就是w1这个web worker
	//alert(ev.data); //web worker中的js里面有些命令是不认的，例如alert就不认。

	self.postMessage(ev.data + '妙味课堂');
}
</code></pre>
<strong>使用Worker提高像素显字的代码性能</strong>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;像素显字&lt;/title&gt;
    &lt;style&gt;
        body {background: #000; color: white; font-size: 30px;}
        #c1 {background: #fff;}
    &lt;/style&gt;
    &lt;script&gt;
        window.onload = function(){
            var oC = document.getElementById('c1');
            var oGC = oC.getContext('2d');
            var aLi = document.getElementsByTagName('li');
            for(var i=0; i&lt;aLi.length; i++){
                aLi[i].onclick = function(){
                    var str = this.innerHTML;
                    var h = 180;
                    oGC.clearRect(0, 0, oC.width, oC.height);
                    oGC.font = h + 'px impact';
                    oGC.fillStyle = 'red';
                    oGC.textBaseline = 'top';
                    var w = oGC.measureText(str).width;
                    oGC.fillText(str, (oC.width - w) / 2, (oC.height - h) / 2);
                    var oImg = oGC.getImageData((oC.width - w) / 2, (oC.height - h) / 2, w, h);
                    oGC.clearRect(0, 0, oC.width, oC.height);

                    //下面启用的Worker
                    var w1 = new Worker('canvas.js');
                    w1.postMessage(w*h);
                    w1.onmessage = function(ev){
                        var arr = ev.data;
                        var newImg = oGC.createImageData(w, h);
                        for(var i = 0; i&lt;arr.length; i++){
                            newImg.data[arr[i]*4] = oImg.data[4*arr[i]];
                            newImg.data[arr[i]*4+1] = oImg.data[4*arr[i]+1];
                            newImg.data[arr[i]*4+2] = oImg.data[4*arr[i]+2];
                            newImg.data[arr[i]*4+3] = oImg.data[4*arr[i]+3];
                        }
                        oGC.putImageData(newImg, (oC.width - w) / 2, (oC.height - h) / 2);
                    }     
                }
            }
        }
    &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;canvas id="c1" width="400" height="400"&gt;&lt;/canvas&gt;
    &lt;ul style="float: left"&gt;
        &lt;li&gt;秒&lt;/li&gt;
        &lt;li&gt;味&lt;/li&gt;
        &lt;li&gt;课&lt;/li&gt;
        &lt;li&gt;堂&lt;/li&gt;
    &lt;/ul&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<pre><code class="language-js">//canvas.js

function randomArr(iAll, iNow){ //从iAll个数里面随机取出iNow个数
    var arr = [];
    var newArr = [];
    for(var i=0; i&lt;iAll; i++){
        arr.push(i);
    }
    for(var i=0; i&lt;iNow; i++){
        newArr.push(arr.splice(Math.floor(Math.random()*arr.length), 1));
    }
    return newArr;
}

self.onmessage = function(ev){
    var arr = randomArr(ev.data, ev.data/10);
    self.postMessage(arr);
}
</code></pre>
<h1 id="html5-1">HTML5其他功能</h1>
<h2 id="section-9">内容编辑</h2>
<ul>
	<li>contenteditable=”true”</li>
</ul>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div contenteditable="true" style="height: 200px; width: 200px; background: red;"&gt;aaaaaaaaaaa&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h2 id="section-10">语言输入</h2>
<ul>
	<li>&lt;input type=”text” x-webkit-speech /&gt;</li>
</ul>
<h2 id="section-11">桌面提醒</h2>
<h1 id="geolocation">地理信息（Geolocation）</h1>
<ul>
	<li>地理位置
<ul>
	<li>经度：南北极的连接线</li>
	<li>维度：东西连接的线</li>
</ul>
</li>
	<li>位置信息从何而来
<ul>
	<li>IP地址</li>
	<li>GPS全球定位系统</li>
	<li>Wi-Fi无线网络</li>
	<li>基站</li>
</ul>
</li>
	<li>地理位置对象
<ul>
	<li>navigator.geolocation
<ul>
	<li>单次定位请求：getCurrentPosition(请求成功, 请求失败, 数据收集方式)</li>
	<li>请求成功函数
<ul>
	<li>经度：coords.longitude</li>
	<li>维度：coords.latitude</li>
	<li>准确度：coords.accuracy</li>
	<li>海拔：coords.altitude</li>
	<li>海拔准确度：coords.altitudeAcuracy</li>
	<li>行进方向：coords.heading</li>
	<li>地面速度：coords.speed</li>
	<li>时间戳：new Date(position.timestamp)</li>
</ul>
</li>
	<li>请求失败函数
<ul>
	<li>失败编号：code</li>
	<li>0：不包括其他错误编号中的错误</li>
	<li>1：用户拒绝浏览器获取位置信息</li>
	<li>2：尝试获取用户信息，但失败了</li>
	<li>3：设置了timeout值，获取位置超时了</li>
</ul>
</li>
	<li>数据收集：json的形式
<ul>
	<li>enableHighAcuracy：更精确的查找，默认false</li>
	<li>timeout：获取位置允许最长时间，默认infinity</li>
	<li>maximumAge：位置可以缓存的最大时间，默认0</li>
</ul>
</li>
	<li>多次定位请求：watchPosition(像setInterval)
<ul>
	<li>移动设备有用，位置改变才会触发</li>
	<li>配置参数：frequency 更新的频率</li>
</ul>
</li>
	<li>关闭更新请求：clearWatch(像clearInterval)</li>
</ul>
</li>
</ul>
</li>
	<li>百度地图API
<ul>
	<li>&lt;script src=”http://api.map.baidu.com/api?v=1.3”&gt;&lt;/script&gt;</li>
	<li>创建基于地图的应用</li>
</ul>
</li>
</ul>
<strong>单次定位请求</strong>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;&lt;/title&gt;
    &lt;script&gt;
    // LBS：基于地理信息的应用
    window.onload = function(){
        var oInput = document.getElementById('input1');
        var oT = document.getElementById('t1');
        
        oInput.onclick = function(){
        
            navigator.geolocation.getCurrentPosition(function(position){
                
                oT.value += '经度:' + position.coords.longitude+'\n';
                oT.value += '纬度 :' + position.coords.latitude+'\n';
                oT.value += '准确度 :' + position.coords.accuracy+'\n';
                oT.value += '海拔 :' + position.coords.altitude+'\n';
                oT.value += '海拔准确度 :' + position.coords.altitudeAcuracy+'\n';
                oT.value += '行进方向 :' + position.coords.heading+'\n';
                oT.value += '地面速度 :' + position.coords.speed+'\n';
                oT.value += '时间戳:' + new Date(position.timestamp)+'\n';
                    
                
            }, function(err){
                
                //err.code // 失败所对应的编号
                
                alert( err.code );
                
            }, {
                enableHighAcuracy : true,
                timeout : 5000,
                maximumAge : 5000
            });
            
        };

    }
    &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;input type="button" value="请求" id="input1"&gt;&lt;br&gt;
&lt;textarea id="t1" style="width: 400px; height: 400px; border: 1px solid #000"&gt;&lt;/textarea&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<strong>多次定位请求</strong>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;&lt;/title&gt;
    &lt;script&gt;
    // LBS：基于地理信息的应用
    window.onload = function(){
        var oInput = document.getElementById('input1');
        var oT = document.getElementById('t1');
        var timer = null;
        
        oInput.onclick = function(){
        
            timer = navigator.geolocation.watchPosition(function(position){
                
                oT.value += '经度:' + position.coords.longitude+'\n';
                oT.value += '纬度 :' + position.coords.latitude+'\n';
                oT.value += '准确度 :' + position.coords.accuracy+'\n';
                oT.value += '海拔 :' + position.coords.altitude+'\n';
                oT.value += '海拔准确度 :' + position.coords.altitudeAcuracy+'\n';
                oT.value += '行进方向 :' + position.coords.heading+'\n';
                oT.value += '地面速度 :' + position.coords.speed+'\n';
                oT.value += '时间戳:' + new Date(position.timestamp)+'\n';
                    
                
            }, function(err){
                
                //err.code // 失败所对应的编号
                alert( err.code );

                navigator.geolocation.clearWatch(timer);
                
            }, {
                enableHighAcuracy : true,
                timeout : 5000,
                maximumAge : 5000,
                frequency : 1000
            });
            
        };

    }
    &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;input type="button" value="请求" id="input1"&gt;&lt;br&gt;
&lt;textarea id="t1" style="width: 400px; height: 400px; border: 1px solid #000"&gt;&lt;/textarea&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<strong>地图应用</strong>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;地图应用&lt;/title&gt;
    &lt;style&gt;
	#div1{ width:400px; height:400px; border:1px #000 solid;}
	&lt;/style&gt;
	&lt;script src="h	ttp://api.map.baidu.com/api?v=1.3"&gt;&lt;/script&gt;
	&lt;script&gt;

	window.onload = function(){
		var oInput = document.getElementById('input1');
		
		oInput.onclick = function(){
			
			navigator.geolocation.getCurrentPosition(function(position){
				
				var y = position.coords.longitude;
				var x = position.coords.latitude;
				
				var map = new BMap.Map("div1");
				
				var pt = new BMap.Point(y, x);
				
				map.centerAndZoom(pt, 14);
				map.enableScrollWheelZoom();
				var myIcon = new BMap.Icon("miaov.png", new BMap.Size(30,30));
				var marker2 = new BMap.Marker(pt,{icon:myIcon});  // 创建标注
				map.addOverlay(marker2); 
				
				var opts = {
				  width : 200,     // 信息窗口宽度
				  height: 60,     // 信息窗口高度
				  title : "妙味课堂"  // 信息窗口标题
				}
				var infoWindow = new BMap.InfoWindow("IT培训机构", opts);  // 创建信息窗口对象
				map.openInfoWindow(infoWindow,pt); //开启信息窗口		
			});
		};
	};
	&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;
&lt;input type="button" value="请求" id="input1" /&gt;
&lt;div id="div1"&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h1 id="section-12">本地存储</h1>
<ul>
	<li>cookie
<ul>
	<li>数据存储到计算机中，通过浏览器控制添加与删除数据</li>
</ul>
</li>
	<li>cookie的特点
<ul>
	<li>存储限制
<ul>
	<li>域名100个cookie，每组值大小4KB</li>
</ul>
</li>
	<li>客户端、服务器端，都会请求服务器（头信息）</li>
	<li>页面间的cookie是共享的</li>
</ul>
</li>
	<li>storage
<ul>
	<li>sessionStorage
<ul>
	<li>session临时回话，从页面打开到页面关闭的时间段</li>
	<li>窗口的临时存储，页面关闭，本地存储消失</li>
</ul>
</li>
	<li>localStorage
<ul>
	<li>永久存储（可以手动删除数据）</li>
</ul>
</li>
</ul>
</li>
	<li>storage的特点
<ul>
	<li>存储量限制（5M）</li>
	<li>客户端完成，不会请求服务器处理</li>
	<li>sessionStorage数据是不共享、localStorage共享</li>
</ul>
</li>
	<li>storage API
<ul>
	<li>setItem()
<ul>
	<li>设置数据，key\value类型，类型都是字符串</li>
	<li>可以用获取属性的形式操作</li>
</ul>
</li>
	<li>getItem()
<ul>
	<li>获取数据，通过key来获取到相应的value</li>
</ul>
</li>
	<li>removeItem()
<ul>
	<li>删除数据，通过key来删除相应的value</li>
</ul>
</li>
	<li>clear()
<ul>
	<li>删除全部存储的值</li>
</ul>
</li>
	<li>例子：保存注册信息</li>
	<li>存储事件
<ul>
	<li>当数据有修改或删除的情况下，就会触发storage事件</li>
	<li>在对数据进行改变的窗口对象上是不会触发的</li>
	<li>key：修改或删除的key值，如果调用clear()，key为null</li>
	<li>newValue：新设置的值，如果调用removeStorage()，key为null</li>
	<li>oldValue：调用改变前的value值</li>
	<li>storageArea：当前的storage对象</li>
	<li>url：触发该脚本变化的文档的url</li>
	<li>注：session同窗口才可以，例子：iframe操作</li>
</ul>
</li>
	<li>例子：同步购物车</li>
</ul>
</li>
	<li>综合实例
<ul>
	<li>行走日记
<ul>
	<li>地图</li>
	<li>本地存储</li>
</ul>
</li>
</ul>
</li>
</ul>
<strong>Storage API</strong>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;本地存储&lt;/title&gt;
    &lt;style&gt;&lt;/style&gt;
    &lt;script&gt;
    window.onload = function(){
        var aInput = document.getElementsByTagName('input');
        aInput[0].onclick = function(){ //设置
            // sessionStorage : 临时性存储
            // localStorage : 永久性存储
            
            //window.sessionStorage.setItem('name', aInput[3].value);
            window.localStorage.setItem('name', aInput[3].value);
        }

        aInput[1].onclick = function(){ //获取
            //alert(window.sessionStorage.getItem('name'));
            alert(window.localStorage.getItem('name'));
        }

        aInput[2].onclick = function(){ //删除
            //window.localStorage.removeItem('name');
            window.localStorage.clear(); //删除全部数据
        }
    }
    &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;input type="button" value="设置"&gt;
&lt;input type="button" value="获取"&gt;
&lt;input type="button" value="删除"&gt;
&lt;input type="text"&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<strong>保存注册信息</strong>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;保存注册信息&lt;/title&gt;
    &lt;style&gt;&lt;/style&gt;
    &lt;script&gt;
    window.onload = function(){
        var aInput = document.getElementsByTagName('input');
        var oT = document.getElementById('t1');

        if(window.localStorage.getItem('name')){
            aInput[0].value = window.localStorage.getItem('name');
        }

        if(window.localStorage.getItem('sex')){
           for(var i=1; i&lt;aInput.length; i++){
            if(aInput[i].value == window.localStorage.getItem('sex')){
                aInput[i].checked = true;
            }
           }
        }

        if(window.localStorage.getItem('ta')){
           oT.value = window.localStorage.getItem('ta');
        }

        window.onunload = function(){
            if(aInput[0].value){
                window.localStorage.setItem('name', aInput[0].value);
            }

            for(var i=1; i&lt;aInput.length; i++){
                if(aInput[i].checked == true){
                    window.localStorage.setItem('sex', aInput[i]);
                }
            }

            if(oT.value){
                window.localStorage.setItem('ta', oT.value);
            }
        }
    }
    &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;p&gt;
    用户名：&lt;input type="text"&gt;
&lt;/p&gt;
&lt;p&gt;
    性别：男 &lt;input type="radio" name="sex"&gt;女 &lt;input type="radio" name="sex"&gt;
&lt;/p&gt;
内容：&lt;textarea id="t1"&gt;&lt;/textarea&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<strong>storage事件</strong>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;本地存储&lt;/title&gt;
    &lt;style&gt;&lt;/style&gt;
    &lt;script&gt;
    window.onload = function(){
        var aInput = document.getElementsByTagName('input');
        aInput[0].onclick = function(){
            window.localStorage.setItem('name', aInput[3].value);
        }

        aInput[1].onclick = function(){ 
            alert(window.localStorage.getItem('name'));
        }

        aInput[2].onclick = function(){
            window.localStorage.removeItem('name');
        }

        window.addEventListener('storage', function(ev){ //当前页面的事件不会触发，其他页面会触发
            alert(123);
            
            console.log(ev.key);
            console.log(ev.newValue);
            console.log(ev.oldValue);
            console.log(ev.storageArea);
            console.log(ev.url);

        }, false);
    }
    &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;input type="button" value="设置"&gt;
&lt;input type="button" value="获取"&gt;
&lt;input type="button" value="删除"&gt;
&lt;input type="text"&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<strong>同步购物车</strong>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;同步购物车&lt;/title&gt;
    &lt;style&gt;&lt;/style&gt;
    &lt;script&gt;
    window.onload = function(){
        var aInput = document.getElementsByTagName('input');

        for(var i=0; i&lt;aInput.length; i++){
            aInput[i].onclick = function(){
                if(this.checked){
                    window.localStorage.setItem('sel', this.value);
                } else {
                    window.localStorage.setItem('unSel', this.value)
                }
            }
        }

        window.addEventListener('storage', function(ev){
            if(ev.key == 'sel'){
                for(var i=0; i&lt;aInput.length; i++){
                    if(ev.newValue == aInput[i].value){
                        aInput[i].checked = true;
                    }
                }
            } else if(ev.key == 'unSel'){
                for(var i=0; i&lt;aInput.length; i++){
                    if(ev.newValue == aInput[i].value){
                        aInput[i].checked = false;
                    }
                }
            }
        }, false);
    }
    &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;input type="checkbox" value="香蕉"&gt;香蕉&lt;br&gt;
&lt;input type="checkbox" value="苹果"&gt;苹果&lt;br&gt;
&lt;input type="checkbox" value="西瓜"&gt;西瓜&lt;br&gt;
&lt;input type="checkbox" value="哈密瓜"&gt;哈密瓜&lt;br&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<strong>行走日记</strong>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt;
&lt;title&gt;无标题文档&lt;/title&gt;
&lt;style&gt;
*{ margin:0; padding:0;}
li{ list-style:none;}
#div1,#div2{ float:left; width:400px; height:400px; border:1px #000000 solid; margin:10px; position:relative; overflow:hidden;}
#div2 ul{ position:absolute; left:0; width:2000px;}
#div2 ul .box{ width:400px; height:400px; float:left; overflow:hidden;}
#div2 #childUl{ width:400px;}
#childUl li{ width:400px; border-bottom:1px #666666 dashed;}
#map{ width:100%; height:380px;}
&lt;/style&gt;
&lt;script src="move.js"&gt;&lt;/script&gt;
&lt;script src="http://api.map.baidu.com/api?v=1.3"&gt;&lt;/script&gt;
&lt;script&gt;

window.onload = function(){
	var oDiv = document.getElementById('div1');
	var aInput = oDiv.getElementsByTagName('input');
	var oT = document.getElementById('t1');
	
	var iNow = window.localStorage.getItem('num') || 0;
	
	var oChildUl = document.getElementById('childUl');
	var aChildLi = oChildUl.getElementsByTagName('li');
	
	var oUl = document.getElementById('ul1');
	var aBox = oUl.getElementsByClassName('box');
	
	var aBox1_input = aBox[1].getElementsByTagName('input');
	var aBox1_div = aBox[1].getElementsByTagName('div');
	
	var oBox2_input = aBox[2].getElementsByTagName('input')[0];
	var index = 0;
	
	if( window.localStorage.getItem('num') ){
		
		for(var i=0;i&lt;iNow;i++){
			
			var oLi = document.createElement('li');
			oLi.innerHTML = window.localStorage.getItem('title'+i);
			oChildUl.appendChild( oLi );
			
		}
		
		changeLi();
		
	}
	
	
	aInput[1].onclick = function(){  //保存本地
	
		window.localStorage.setItem('title'+iNow,aInput[0].value);
		window.localStorage.setItem('ta'+iNow,oT.value);
		
		createLi();
		
		iNow++;
		
		window.localStorage.setItem('num',iNow);
	
	};
	
	aInput[2].onclick = function(){ //提交后台
	};
	
	aInput[3].onclick = function(){ //删除所有的数据
		window.localStorage.clear();
	};
	
	aInput[4].onclick = function(){
		
		var This = this;
		
		navigator.geolocation.getCurrentPosition(function(position){
			
			var y = position.coords.longitude;
			var x = position.coords.latitude;
			
			
			if( This.checked ){
				window.localStorage.setItem('y'+iNow,y);
				window.localStorage.setItem('x'+iNow,x);
			}
			else{
				window.localStorage.removeItem('y'+iNow);
				window.localStorage.removeItem('x'+iNow);
			}
			
			
		});
		
		
		
	};
	
	function createLi(){
		
		var oLi = document.createElement('li');
		oLi.innerHTML = window.localStorage.getItem('title'+iNow);
		oChildUl.appendChild( oLi );
		
		changeLi();
		
	}
	
	function changeLi(){
		
		for(var i=0;i&lt;aChildLi.length;i++){
			aChildLi[i].index = i;
			aChildLi[i].onclick = function(){
				
				startMove(oUl,{left : -aBox[0].offsetWidth });
				
				aBox1_div[0].innerHTML = window.localStorage.getItem('title'+this.index);
				aBox1_div[1].innerHTML = window.localStorage.getItem('ta'+this.index);
				
				
				if( window.localStorage.getItem('y'+this.index) ){
					aBox1_input[1].disabled = false;
					
				}
				else{
					aBox1_input[1].disabled = true;
				}
				
				index = this.index;
				
			};
		}
		
	}
	
	aBox1_input[0].onclick = function(){
		
		startMove(oUl,{left : 0});
		
	};
	
	aBox1_input[1].onclick = function(){
		
		startMove(oUl,{left : -2*aBox[0].offsetWidth});
		
		
		var map = new BMap.Map("map");            
		var y = window.localStorage.getItem('y'+index);
		var x = window.localStorage.getItem('x'+index);
		var title = window.localStorage.getItem('title'+index);
		var text = window.localStorage.getItem('ta'+index);
		var point = new BMap.Point(y, x);    
		map.centerAndZoom(point,15);                    
		map.enableScrollWheelZoom();
		
		var marker1 = new BMap.Marker(point);
		map.addOverlay(marker1); 
		
		var opts = {
		  width : 250,     // 信息窗口宽度
		  height: 100,     // 信息窗口高度
		  title : title  // 信息窗口标题
		}
		
		var infoWindow = new BMap.InfoWindow(text, opts);
		map.openInfoWindow(infoWindow,point);
		
		
	};
	
	oBox2_input.onclick = function(){
		
		startMove(oUl,{left : -aBox[0].offsetWidth });
		
	};
	
};

&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;
&lt;div id="div1"&gt;
标题:&lt;input type="text" /&gt;&lt;br /&gt;
内容:&lt;textarea id="t1" style="height:300px; width:300px;"&gt;&lt;/textarea&gt;&lt;br /&gt;
&lt;input type="button" value="保存本地" /&gt;
&lt;input type="button" value="同步服务器" /&gt;
&lt;input type="button" value="删除所有数据" /&gt;
&lt;input type="checkbox" /&gt;记录地图位置
&lt;/div&gt;
&lt;div id="div2"&gt;
	&lt;ul id="ul1"&gt;
		&lt;li class="box"&gt;
			&lt;ul id="childUl"&gt;
			&lt;/ul&gt;
		&lt;/li&gt;
		&lt;li class="box"&gt;
			&lt;input type="button" value="后退" /&gt;
			&lt;input style="float:right" type="button" value="前进" /&gt;
			&lt;div&gt;&lt;/div&gt;
			&lt;div&gt;&lt;/div&gt;
		&lt;/li&gt;
		&lt;li class="box"&gt;
			&lt;input type="button" value="后退" /&gt;
			&lt;div id="map"&gt;&lt;/div&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;

</code></pre>
<h1 id="section-13">音频和视频</h1>
<ul>
	<li>标签
<ul>
	<li>audio、video</li>
	<li>source</li>
</ul>
</li>
	<li>视频容器
<ul>
	<li>容器文件，类似于压缩了一组文件
<ul>
	<li>音轨频道</li>
	<li>视频轨道</li>
	<li>元数据：封面、标题、字幕等</li>
	<li>格式：.avi、.flv、.mp4、.mkv、.ogv等</li>
</ul>
</li>
</ul>
</li>
	<li>编解码器
<ul>
	<li>原始的视频容器非常大，添加需编码，播放需解码</li>
	<li>音频编解码器
<ul>
	<li>AAC、MPEG-3、Ogg Vorbis</li>
</ul>
</li>
	<li>视频编解码器
<ul>
	<li>H.264、VP8、Ogg Theora</li>
</ul>
</li>
</ul>
</li>
	<li>媒体元素
<ul>
	<li>controls：显示或隐藏用户控制界面</li>
	<li>autoplay：媒体是否自动播放</li>
	<li>loop：媒体是否循环播放</li>
	<li>currentTime：开始到播放现在所用的时间</li>
	<li>duration：媒体总时间（只读）</li>
	<li>volume：0.0 — 1.0 的音量相对值</li>
	<li>muted：是否静音</li>
	<li>autobuffer：开始的时候是否缓冲加载，autoplay的时候，忽略此属性</li>
	<li>paused：媒体是否暂停（只读）</li>
	<li>ended：媒体是否播放完毕（只读）</li>
	<li>error：媒体发声错误的时候，返回错误代码（只读）</li>
	<li>currentSrc：以字符串的形式返回媒体地址（只读）</li>
	<li>play()：媒体播放</li>
	<li>pause()：媒体暂停</li>
	<li>load()：重新加载媒体</li>
	<li>媒体元素中的事件：loadstart progress suspend emptied stalled play pause loadedmetadata loadeddata waiting playing canplay canplaythrough seeking seeked timeupdate ended ratechange durationchange volumechange</li>
</ul>
</li>
	<li>video额外特性
<ul>
	<li>poster：视频播放前的预览图片</li>
	<li>width、height：设置视频的尺寸</li>
	<li>videoWidth、videoHeight：视频的实际尺寸（只读）</li>
	<li>例子：带声音的导航</li>
	<li>例子：视频与canvas结合</li>
	<li>例子：自制播放器</li>
	<li><a href="http://www.alloyteam.com/wp-content/uploads/2012/03/palydemo/index.html">http://www.alloyteam.com/wp-content/uploads/2012/03/palydemo/index.html</a></li>
</ul>
</li>
</ul>
<strong>音视频的基本操作</strong>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;HTML5音视频&lt;/title&gt;
    &lt;style&gt;&lt;/style&gt;
    &lt;script&gt;
    window.onload = function(){
        var oA = document.getElementById('a1');
        var oV = document.getElementById('v1');
        var oInput = document.getElementById('input1');
        var aS = document.getElementsByTagName('source');

        // setInterval(function(){
        //     console.log(oA.currentTime);
        // }, 1000);
        
        oA.currentTime = 60; //音频从60秒开始播放 currentTime属性既可以读取也可以设置
        console.log(oA.duration);
        console.log(oA.volume);
        console.log(oA.muted); //静音就返回真；否则就返回假
        console.log(oA.paused);
        console.log(oA.ended);
        console.log(oA.error);
        console.log(oA.currentSrc);

        oV.onmouseover = function(){
            this.play();
        }
        oV.onmouseout = function(){
            this.pause();
        }

        oInput.onclick = function(){
            aS[0].src = 'XXXX.mp4';
            aS[1].src = 'XXXX.ogv';

            oV.load();
        }

        oV.poster = 'images/1.png';

        oV.addEventListener('ended', function(){
            alert(123);
        }, false)
    }
    &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;!-- &lt;audio controls src="johann_sebastian_bach_air.mp3"&gt;&lt;/audio&gt;
&lt;audio controls src="johann_sebastian_bach_air.ogg"&gt;&lt;/audio&gt;
&lt;video controls src="Intermission-Walk-in_512kb.mp4"&gt;&lt;/video&gt;
&lt;video controls src="Intermission-Walk-in.ogv"&gt;&lt;/video&gt; --&gt;

&lt;!-- &lt;video controls&gt;
    //先找第一个source，如果浏览器不支持第一个，就找下一个
    &lt;source src="Intermission-Walk-in.ogv"&gt;&lt;/source&gt;
    &lt;source src="Intermission-Walk-in_512kb.mp4"&gt;&lt;/source&gt;
&lt;/video&gt; --&gt;

&lt;audio id="a1" controls autobuffer src="johann_sebastian_bach_air.mp3"&gt;&lt;/audio&gt;

&lt;input type="button" value="重新加载" id="input1"&gt;
&lt;video id="v1"&gt;
    //先找第一个source，如果浏览器不支持第一个，就找下一个
    &lt;source src="Intermission-Walk-in.ogv"&gt;&lt;/source&gt;
    &lt;source src="Intermission-Walk-in_512kb.mp4"&gt;&lt;/source&gt;
&lt;/video&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<strong>带声音的导航</strong>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;带声音的导航&lt;/title&gt;
    &lt;style&gt;
    * {margin: 0; padding: 0;}
    #ul1 {width: 1000px; height: 30px;}
    #ul1 li {list-style: none; width: 100px; height: 30px; background: red; color: white; border: 1px solid #000; float: left; text-align: center; line-height: 30px;}
    &lt;/style&gt;
    &lt;script&gt;
    window.onload = function(){
        var aLi = document.getElementsByTagName('li');
        var oA = document.getElementById('a1');

        for(var i=0; i&lt;aLi.length; i++){
            aLi[i].onmouseover = function(){
                //this.getAttribute('au')
                oA.src = 'http://s8.qhimg.com/share/audio/piano1/' + this.getAttribute('au') + '4.mp3';
                oA.play();
            }
        }
    }
    &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;ul id="ul1"&gt;
    &lt;li au="c"&gt;00001&lt;/li&gt;
    &lt;li au="d"&gt;00002&lt;/li&gt;
    &lt;li au="e"&gt;00003&lt;/li&gt;
    &lt;li au="f"&gt;00004&lt;/li&gt;
    &lt;li au="g"&gt;00005&lt;/li&gt;
    &lt;li au="a"&gt;00006&lt;/li&gt;
    &lt;li au="b"&gt;00007&lt;/li&gt;
&lt;/ul&gt;
&lt;audio id="a1"&gt;&lt;/audio&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<strong>视频与canvas结合</strong>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;视频与canvas结合&lt;/title&gt;
    &lt;style&gt;&lt;/style&gt;
    &lt;script&gt;
    window.onload = function(){
        var oV = document.getElementById('v1');
        var oC = document.getElementById('c1');
        var oGC = oC.getContext('2d');

        oC.width = oV.videoWidth;
        oC.height = oV.videoHeight;

        setInterval(function(){
            oGC.drawImage(oV, 0, 0); //drawImage里面也可以添加视频
        }, 30);
    }
    &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;video controls id="v1"&gt;
    &lt;source src="Intermission-Walk-in.ogv"&gt;&lt;/source&gt;
    &lt;source src="Intermission-Walk-in.mp4"&gt;&lt;/source&gt;
&lt;/video&gt;
&lt;canvas id="c1"&gt;&lt;/canvas&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<strong>自制播放器</strong>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;head&gt;
&lt;title&gt;无标题文档&lt;/title&gt;
&lt;style&gt;
*{ margin:0; padding:0;}
#div1{ width:300px; height:30px; background:#666; overflow:hidden; position:relative;}
#div2{ width:60px; height:30px; background:red; position:absolute; left:0; top:0;}

#div3{ width:300px; height:10px; background:#666; overflow:hidden; position:relative; top:10px;}
#div4{ width:60px; height:10px; background:yellow; position:absolute; left:240px; top:0;}

&lt;/style&gt;
&lt;script&gt;

window.onload = function(){
	var oV = document.getElementById('v1');
	var aInput = document.getElementsByTagName('input');	
	var oDiv1 = document.getElementById('div1');
	var oDiv2 = document.getElementById('div2');
	var oDiv3 = document.getElementById('div3');
	var oDiv4 = document.getElementById('div4');	
	var disX = 0;
	var disX2 = 0;	
	var timer = null;
	
	aInput[0].onclick = function(){		
		if( oV.paused ){		
			oV.play();		
			this.value = '暂停';		
			nowTime();
			timer = setInterval(nowTime,1000);		
		}else{	
			oV.pause();
			this.value = '播放';
			clearInterval(timer);
		}
	};
	
	
	aInput[2].value = changeTime(oV.duration);
	aInput[3].onclick = function(){
		if( oV.muted ){
			oV.volume = 1;
			this.value = '静音';
			oV.muted = false;
		}else{
			oV.volume = 0;
			this.value = '取消静音';
			oV.muted = true;
		}
	};
	
	aInput[4].onclick = function(){ //全屏方法
		if (oV.requestFullscreen) {
          oV.requestFullscreen();
        } else if (oV.msRequestFullscreen) {
          oV.msRequestFullscreen();
        } else if (oV.mozRequestFullScreen) {
          oV.mozRequestFullScreen();
        } else if (oV.webkitRequestFullscreen) {
          oV.webkitRequestFullscreen();
        }
	};
	
	
	function nowTime(){
		aInput[1].value = changeTime(oV.currentTime);
		var scale = oV.currentTime/oV.duration;
		oDiv2.style.left = scale * 240 + 'px';
	}
	
	function changeTime(iNum){
		iNum = parseInt( iNum );
		var iH = toZero(Math.floor(iNum/3600));
		var iM = toZero(Math.floor(iNum%3600/60));
		var iS = toZero(Math.floor(iNum%60));
		return iH + ':' +iM + ':' + iS;
	}
	
	function toZero(num){
		if(num&lt;=9){
			return '0' + num;
		}
		else{
			return '' + num;
		}
	}
	
	oDiv2.onmousedown = function(ev){
		var ev = ev || window.event;
		disX = ev.clientX - oDiv2.offsetLeft;
		
		document.onmousemove = function(ev){
			var ev = ev || window.event;
			var L = ev.clientX - disX;
			
			if(L&lt;0){
				L = 0;
			}else if(L&gt;oDiv1.offsetWidth - oDiv2.offsetWidth){
				L = oDiv1.offsetWidth - oDiv2.offsetWidth;
			}
			oDiv2.style.left = L + 'px';
			
			var scale = L/(oDiv1.offsetWidth - oDiv2.offsetWidth);
			oV.currentTime = scale * oV.duration;
			nowTime();
			
		};
		document.onmouseup = function(){
			document.onmousemove = null;
		};
		return false;
	};
	
	
	oDiv4.onmousedown = function(ev){
		var ev = ev || window.event;
		disX2 = ev.clientX - oDiv4.offsetLeft;
		
		document.onmousemove = function(ev){
			var ev = ev || window.event;
			var L = ev.clientX - disX2;
			if(L&lt;0){
				L = 0;
			}else if(L&gt;oDiv3.offsetWidth - oDiv4.offsetWidth){
				L = oDiv3.offsetWidth - oDiv4.offsetWidth;
			}
			oDiv4.style.left = L + 'px';
			
			var scale = L/(oDiv3.offsetWidth - oDiv4.offsetWidth);
			oV.volume = scale;
		};
		document.onmouseup = function(){
			document.onmousemove = null;
		};
		return false;
	};
};

&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;video id="v1"&gt;
	&lt;source src="Intermission-Walk-in.ogv"&gt;&lt;/source&gt;
    &lt;source src="Intermission-Walk-in_512kb.mp4"&gt;&lt;/source&gt;
&lt;/video&gt;&lt;br /&gt;
&lt;input type="button" value="播放" /&gt;
&lt;input type="button" value="00:00:00" /&gt;
&lt;input type="button" value="00:00:00" /&gt;
&lt;input type="button" value="静音" /&gt;
&lt;input type="button" value="全屏" /&gt;
&lt;div id="div1"&gt;
	&lt;div id="div2"&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div id="div3"&gt;
	&lt;div id="div4"&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
</div>
<div id="related"></div>
</body>
</html>
